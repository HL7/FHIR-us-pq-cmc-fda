@startuml Stability
allowmixing
'Mixed model of use case and object
skinparam svgDimensionStyle true
skinparam ObjectBackgroundColor LightYellow
skinparam ObjectBorderColor #A80036
skinparam activityDiamondBorderColor #A80036
skinparam activityDiamondBackgroundColor lawnGreen
skinparam ClassBorderThickness 4

package "[[StructureDefinition-cmc-ectd-document-sp7383.html eCTD Heading 3.2.P.8.3, 3.2.S.7.3 and 3.2.P.4.5 Stability Study Bundle]]" as NODES {


    node StabilityStudy as stabilityStudy {
        object **Parent:** ResearchStudy as obj1 {

            **Page:** [[StructureDefinition-pq-stability-study.html]]
            **ValueSets:**
            [[ValueSet-PqcmcStabilityStudyReasonTerminology Stability Study Reason Terminology]]
        }
    }
    node StabilitySubStudy as stabilitySubStudy {
        object **Parent:** ResearchStudy as obj2 {
            **Page:** [[.html]]
            **ValueSets:**
            [[ValueSet-PqcmcStudyTypeTerminology Study Type Terminology]]
            [[ValueSet-PqcmcStorageConditionsTerminology Storage Conditions Terminology]]
            [[ValueSet-PqcmcStorageConditionCategoryTerminology]]
            [[ValueSet-PqcmcContainerOrientationTerminology Container Orientation Terminology]]

            object "**Extensions**" as ext1 {

                [[StructureDefinition-.html Focus & Objective Extension]]
            }
            obj2 *-- ext1

        }
    }
    node StabilityStudyIntervalReport as stabilityStudyIntervalReport {
        object **Parent:** DiagnosticReport as obj3 {

            **Page:** [[.html]]
            **ValueSets:**
            object Study Interval Extension as ext2
            object Quality Specification Extension as ext3
            object Additional Info Extension as ext4
        }
    }

    node StabilityStudyProtocol as stabilityStudyProtocol {
        object **Parent:** PlanDefinition as obj5 {
            **Page:** [[.html]]
            **ValueSets:**

            [[ValueSet-PqcmcTestCategoryParentTerminology]]
            [[ValueSet-PqcmcTestCategoryChildTerminology]]
            [[ValueSet-PqcmcStorageConditionsTerminology]]
            [[ValueSet-PqcmcContainerOrientationTerminology]]
            [[ValueSet-PqcmcContainerTypeTerminology]]
            [[ValueSet-PqcmcClosureTypeTerminology]]
        }
    }

    node CycledTestingPlanDefinition as cycledTestingPlan {
        object **Parent:** PlanDefinition as obj4 { **Page:** [[.html]]
        **ValueSets:**
        [[ValueSet-PqcmcStorageConditionsTerminology]]
        [[ValueSet-PqcmcContainerOrientationTerminology]]
        [[ValueSet-PqcmcContainerTypeTerminology]]
        [[ValueSet-PqcmcClosureTypeTerminology]]
    }

}

node "CodedOrganization" as codedOrganization {

    object "**Parent:** Organization" as objAu {
        **Page:**
        [[StructureDefinition-cmc-organization.html]]
    }
}

node DrugProductBatch as drugProductBatch {
    object **Parent:** Organization as obj6 {

        **Page:** [[.html]]
        **ValueSets:**
        object Drug Product Manufacturing Batch Extension as ext7
        object CmcProductNameTypesVS as vs16
        [[ValueSet-SplPharmaceuticalDosageFormTerminology]]	vs17
        object FHIR UCUM Units ValueSet as vs18
    }
}
node DrugProductHandle as drugProductHandle {
    object **Parent:** Medication as obj7 {

        **Page:** [[.html]]
        **ValueSets:**
    }

}
node DrugProductDescription as drugProductDescription {
    object **Parent:** MedicinalProductDefinition as obj8 {

        **Page:** [[.html]]
        **ValueSets:**
        [[ValueSet-SplPharmaceuticalDosageFormTerminology]]
    }
}
node "DrugSubstanceBatch" as drugSubstanceBatch {

    object "**Parent:** Substance" as obj4 {
        **Page:**
        [[StructureDefinition-pqcmc-drug-substance-batch.html]]

        **ValueSets:**
        [[ValueSet-pqcmc-batch-utilization-terminology.html Batch utilization Terminology]]
        [[ValueSet-pqcmc-container-type-terminology.html Container Type Terminology]]
        [[ValueSet-pqcmc-closure-type-terminology.html Closure Type Terminology]]
        [[ValueSet-pqcmc-expiration-date-classification-terminology.html Expiration Date Classification]]
        UCUM Codes
    }
    object "**Extensions**" as objXDs {

        [[StructureDefinition-drug-substance-manufacturing-batch.html Drug Substance Manufacturing Batch]]
    }
    obj4 *-- objXDs
}

node "MfgSiteOrganization" as  MfgSiteOrganization {
    object "**Parent:** CodedOrganization" as obj5 {
        **Page:**
        [[StructureDefinition-mfg-test-site-organization.html]]

        **ValueSets:**
        [[ValueSet-pqcmc-mfg-testing-site-terminology.html Manufacturing/Testing Site Responsibility Category]]
    }
}

node "ResultObservation" as resultObservation  {

    object "**Parent:** Observation" as obj6 {
        **Page:**
        [[StructureDefinition-pq-result-observation.html]]

        **ValueSets:**
        [[ValueSet-pqcmc-test-category-terminology.html Test Category Terminology]]
        [[ValueSet-pqcmc-conformance-to-criteria-terminology.html Conformance Criteria Terminology]]
        [[ValueSet-pqcmc-test-category-terminology.html Test Category]]
        UCUM Codes

    }

    object "**Extensions**" as objXObs {
        [[StructureDefinition-pq-replicate-extension.html Replicate]]
        [[StructureDefinition-pq-batch-range.html Batch Target Range]]
        [[StructureDefinition-pq-additional-info-extension.html Additional Information]]
        [[StructureDefinition-pq-pullDate-extension.html Pull Date (Stability Only) ]]
    }
    obj6 *-- objXObs
}

node "EctdCompositionSP7383" asectdComposition {

    object "**Parent:** Composition" as obj1 {
        **Page:**
        [[StructureDefinition-ectd-composition-sp7383.html]]
        **ValueSets:**
        Code system PQCMC Comp Section Types
    }
}

diamond CH

stabilityStudy -[#darkred]--> stabilityStudyProtocol
stabilityStudy -[#darkred]--> drugProductHandle
stabilitySubStudy -[#darkred]--> stabilityStudyProtocol
stabilitySubStudy -[#darkred]--> stabilityStudy
stabilitySubStudy -[#darkred]--> cycledTestingPlan
stabilitySubStudy -[#darkred]--> stabilityStudyIntervalReport
stabilityStudyIntervalReport -[#darkred]--> drugProductBatch
stabilityStudyIntervalReport -[#darkred]--> drugSubstanceBatch
stabilityStudyIntervalReport -[#darkred]--> codedOrganization
stabilityStudyIntervalReport -[#darkred]--> resultObservation
drugProductBatch -[#darkred]--> codedOrganization
resultObservation -[#darkred]--> codedOrganization
ectdComposition -[#darkred]--> codedOrganization
ectdComposition -[#darkred]--> stabilityStudy
resultObservation -[#darkred]-> MfgSiteOrganization
resultObservation -[#darkred]--> resultObservation : Only used for Staged or multi-measurement tests
CH -[#green]--> drugProductBatch
CH -[#green]--> drugSubstanceBatch
}
@enduml
