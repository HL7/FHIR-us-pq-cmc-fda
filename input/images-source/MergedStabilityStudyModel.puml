
@startuml
title Stability Study Model with Group Backbone Element

package "Study Control" {
  component "ResearchStudy - Defines Stability Study" as RS
  folder "PlanDefinition - Study Protocol" as PD
  rectangle "PlanDefinition.actionTimepoints / Test Logic" as Action
}

package "Product Enrollment via Group Backbone" {
  rectangle "ResearchStudy.group: Low Strength" as G_Low #LightBlue
  rectangle "ResearchStudy.group: Middle Strength - Bracketed" as G_Mid
  rectangle "ResearchStudy.group: High Strength" as G_High #LightBlue
  rectangle "ResearchStudy.group: Batch 1" as G_B1
  rectangle "ResearchStudy.group: Batch 2  - Matrixed" as G_B2
  rectangle "ResearchStudy.group: Cycled Batch" as G_Cycle
}

package "Observations" {
  note "Obs: Expiration - Low" as Obs_Low #LightBlue
  note "Obs: Expiration - High" as Obs_High #LightBlue
  note "Obs: Expiration - Interpolated  - Mid" as Obs_Mid #LightGrey
  note "Obs: Matrixed Result - B2" as Obs_Matrix
  note "Obs: Freeze Result" as Obs_Freeze
  note "Obs: Thaw Result" as Obs_Thaw
}

package "Evidence2" {
  folder "Evidence Regression Justification" as Evidence
}

package "Extensions" {
  "Extension: indirectlyTested - true" 
  "Extension: matrixingType - timepoints"  
}

' Relationships
RS --> PD : protocol →
PD --> Action : includes

' ResearchStudy groups  - backbone elements
RS --> G_Low : group →
RS --> G_Mid : group →
RS --> G_High : group →
RS --> G_B1 : group →
RS --> G_B2 : group →
RS --> G_Cycle : group →

' Bracketed middle group marked untested
G_Mid --> Ext_Bracket

' Matrixed batch group
G_B2 --> Ext_Matrix

' Observations linked to groups
Obs_Low --> G_Low : subject →
Obs_High --> G_High : subject →
Obs_Matrix --> G_B2 : subject →
Obs_Freeze --> G_Cycle : subject →
Obs_Thaw --> G_Cycle

' Interpolated observation
Obs_Mid --> G_Mid : subject →
Obs_Mid --> Obs_Low : derivedFrom →
Obs_Mid --> Obs_High

' Evidence supports interpolated result
Evidence --> Obs_Mid : outcome →
Evidence --> G_Mid : exposureVariant →
Evidence ..> Obs_Low : supporting →
Evidence ..> Obs_High

' Observations linked to PlanDefinition actions  - for cycled study
Obs_Freeze --> Action : partOf →
Obs_Thaw --> Action : partOf →

@enduml
